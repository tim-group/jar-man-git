[![Build Status](https://travis-ci.org/tim-group/jar-man-git.svg?branch=master)](https://travis-ci.org/tim-group/jar-man-git)

# JarManGit
I believe we have a general problem of traceability for the artifacts that we produce. The version numbers of our jars (both library jars and executable production jars) are generated by jenkins, and this gives a poor indication of the source code that they contain.

In order to address this problem, I have written two plugins, one for sbt and one for gradle. These plugins make a small change to the artifact generation stage so that both the pom.xml and the jarâ€™s manifest get additional metadata indicating the git repo and git hash against which they were built.

This repo contains build tool plugins that will do two things:

1) include the following tags in the Jar **META-INF/MANIFEST.MF**
```text
  Git-Origin: git@git.net.local:coolproject
  Git-Repo-Is-Clean: false
  Git-Branch: master
  Git-Head-Rev: b178b10c259bb1442bcf27012c305a50c26796a2
```

2) include the following section in the **pom.xml**
```xml
  <scm>
    <url>git@git.net.local:coolproject</url>
    <tag>b178b10c259bb1442bcf27012c305a50c26796a2</tag>
  </scm>
```

Once we add the plugins to our builds, we will start to build up a record of which commits make it into which artifacts. With this information available consistently, in a machine-readable way, we can start to build tools that will improve transparency.

## Instructions for adding the plugin to your builds

### Gradle
[example](https://github.com/tim-group/Tucker/blob/c3c31098092944578e1b662109c56aa2ac460a7c/build.gradle#L4)

Add the plugin in the `plugins { }` block at the top of your build file:

```groovy
plugins {
    id "com.timgroup.jarmangit" version "1.2.0"
}
```

### SBT
[example](http://git.net.local/gitweb/?p=mysql-eventstore.git;a=commitdiff;h=d6cf5c23f005ba6ba9e34d5ff6e038646f94532f)

Create a new file (sbt-jarmangit.sbt) in the project directory, with the following content:

```scala
  addSbtPlugin("com.timgroup" % "sbt-jarmangit" % "1.0.14")
```
